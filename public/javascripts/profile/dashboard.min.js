let dashboard={wrapper:void 0,dpEl:void 0,nameEl:void 0,locationEl:void 0,bioEl:void 0,nameTemp:void 0,bioTemp:void 0,dpTemp:void 0,locationTemp:void 0,allDP:void 0,initialise:(void 0,async()=>{let e;dashboard.declareVariables();try{e=await dashboard.fetchDetails()}catch(e){return}dashboard.populateDetails(e),dashboard.addListener();let d=profile.allProjects.filter(e=>e.bookmark).slice(0,3);const r=document.getElementsByClassName("db-proj-item");for(var t=0;t<3;t++)dashboard.renderProjects(d[t],r[t],!0);d.length?document.getElementById("db-proj-none").style.display="none":document.getElementById("db-proj-none").style.display="block";let a=new Date;document.getElementById("profile-today").innerHTML="Today is "+a.toLocaleString("default",{month:"short"})+" "+a.getDate()+" "+a.getFullYear()}),declareVariables:(void 0,()=>{dashboard.wrapper=document.querySelector(".db-profile-wrapper"),dashboard.dpEl=document.getElementById("profile-preview"),dashboard.nameEl=document.getElementById("profile-name"),dashboard.locationEl=document.getElementById("profile-location"),dashboard.bioEl=document.getElementById("profile-bio"),dashboard.allDP=[document.getElementById("nav-dp"),document.getElementById("nav-user-in"),document.getElementById("nav-profile-img")]}),addListener:(void 0,()=>{document.getElementById("profile-edit-btn-mobile").addEventListener("click",()=>{dashboard.wrapper.classList.toggle("db-profile-wrapper-edit")}),document.getElementById("profile-edit-btn-dsktp").addEventListener("click",()=>{dashboard.wrapper.classList.toggle("db-profile-wrapper-edit")}),document.getElementById("profile-save-btn").addEventListener("click",async()=>{dashboard.wrapper.classList.toggle("db-profile-wrapper-edit");for(var e=0;e<dashboard.allDP.length;e++)dashboard.allDP[e].src=dashboard.dpEl.src}),document.getElementById("profile-cancel-btn").addEventListener("click",()=>{dashboard.nameEl.innerHTML=dashboard.nameTemp,dashboard.bioEl.innerHTML=dashboard.bioTemp,dashboard.dpEl.src=dashboard.dpTemp,dashboard.wrapper.classList.toggle("db-profile-wrapper-edit")}),document.getElementById("db-order-view").addEventListener("click",()=>{profile.setPage("orders")}),document.getElementById("db-proj-view").addEventListener("click",()=>{profile.setPage("projects")}),document.getElementById("db-email").addEventListener("click",()=>{settings.editEmail(),profile.setPage("settings")}),document.getElementById("db-password").addEventListener("click",()=>{settings.editPassword(),profile.setPage("settings")}),document.getElementById("db-subscription").addEventListener("click",()=>{profile.setPage("settings")}),document.getElementById("db-address").addEventListener("click",()=>{settings.editAddress(),profile.setPage("settings")}),document.getElementById("db-delete").addEventListener("click",()=>{profile.setPage("settings")})}),fetchDetails:(void 0,()=>new Promise(async(e,d)=>{let r;try{r=(await axios.get("/profile/dashboard/fetch-details")).data}catch(e){r={status:"error",content:e}}return"error"===r.status||"failed"===r.status?d():e(r.content)})),populateDetails:(void 0,e=>{dashboard.nameEl.innerHTML=e.displayName,dashboard.locationEl.innerHTML=e.address.city+", "+e.address.country,dashboard.bioEl.innerHTML=e.bio,dashboard.nameTemp=dashboard.nameEl.innerHTML,dashboard.bioTemp=dashboard.bioEl.innerHTML,dashboard.dpTemp=dashboard.dpEl.src;const d=moment(e.date.created).format("MMM YYYY");document.querySelector("#profile-account-creation-date").innerHTML=d}),previewImage:(void 0,e=>{document.getElementById("profile-preview").src=URL.createObjectURL(e.target.files[0])}),saveDetails:(void 0,async()=>{const e={displayName:dashboard.nameEl.innerHTML,bio:dashboard.bioEl.innerHTML};let d;try{d=await axios.post("/profile/customer/update",e)}catch(e){d={status:"error",content:e}}"error"!==d.status&&"failed"!==d.status&&(dashboard.nameTemp=dashboard.nameEl.innerHTML,dashboard.bioTemp=dashboard.bioEl.innerHTML,dashboard.dpTemp=dashboard.dpEl.src)}),uploadPicture:(void 0,async()=>{const e=new FormData(document.querySelector("#profile-pic"));let d;try{d=(await axios.post("/profile/customer/update/picture",e)).data}catch(e){return}}),save:(void 0,async()=>{let e;let d;e=0!==document.getElementById("profile-upload").files.length?await global.compressImage("profile-pic","picture",400):new FormData,e.append("displayName",dashboard.nameEl.innerHTML),e.append("bio",dashboard.bioEl.innerHTML);try{d=(await axios.post("/profile/dashboard/save",e)).data}catch(e){d={status:"error",content:e}}"failed"!==d.status&&"error"!==d.status&&(dashboard.nameTemp=dashboard.nameEl.innerHTML,dashboard.bioTemp=dashboard.bioEl.innerHTML,dashboard.dpTemp=dashboard.dpEl.src)}),renderProjects:(void 0,(e,d,r)=>{if(e){d.style.visibility="visible",d.setAttribute("onclick",`dashboard.goToProject('${e.id}');`),d.id=e.id+"-db-proj",d.querySelector(".db-proj-name").innerHTML=e.name;let t=d.querySelector(".db-proj-makes");r?(d.querySelector(".db-proj-img").src="/profile/projects/retrieve-thumbnail/"+e.id+"?"+(new Date).getTime(),e.makes.forEach((function(e,d){""!==t.innerHTML&&(t.innerHTML+=", "),t.innerHTML+=e.file.name}))):(d.querySelector(".db-proj-img").src=document.getElementById(e.id+"-proj-pop-wrapper").querySelector(".proj-pop-img").src,t.innerHTML=e.allMakesString)}else d.style.visibility="hidden"}),goToProject:(void 0,e=>{projects.showProjPop(e),profile.setPage("projects")}),processOrders:(void 0,e=>{let d=e.slice(0,3),r=document.getElementsByClassName("db-order-item");for(var t=0;t<3;t++)dashboard.renderOrders(d[t],r[t]);d.length?document.getElementById("db-order-none").style.display="none":document.getElementById("db-order-none").style.display="block"}),renderOrders:(void 0,(e,d)=>{if(e){let r;switch(d.style.visibility="visible",d.setAttribute("onclick",`dashboard.goToOrder('${e._id}');`),d.id=e._id+"-db-order",d.querySelector(".db-order-number").innerHTML="Order #"+e.number,e.status){case"checkedout":r="Validating Payment";break;case"validated":r="Building Order";break;case"built":r="Packaging Order";break;case"reviewed":r="Order Reviewed";break;case"completed":r="Order Completed";break;case"cancelled":r="Refunding Order";break;case"refunded":r="Order Refunded";break;default:break}if("pickup"===e.shipping.method)switch(e.status){case"shipped":r="Ready for Pickup";break;case"arrived":r="Package Picked Up";break;default:break}else switch(e.status){case"shipped":r="Package Shipped";break;case"arrived":r="Package Arrived";break;default:break}d.querySelector(".db-order-delivery").querySelector("span").innerHTML=r,d.querySelector(".db-order-date").querySelector("span").innerHTML=orders.formatDate(e.date[e.status]),"new"===e.shipping.address.option?d.querySelector(".db-order-address").querySelector("span").innerHTML=`${e.shipping.address.new.city}, ${e.shipping.address.new.country}`:d.querySelector(".db-order-address").querySelector("span").innerHTML=`${e.shipping.address.saved.city}, ${e.shipping.address.saved.country}`,d.querySelector(".db-order-amount").innerHTML="$"+global.priceFormatter(e.payment.amount.total.total),"completed"!==e.status&&"refunded"!==e.status||d.classList.add("db-order-past")}else d.style.visibility="hidden"}),goToOrder:(void 0,e=>{orders.selectOrder(e),profile.setPage("orders")})};